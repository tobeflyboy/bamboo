# 激活actuator 部分端点
management:
  endpoint:
    health:
      show-details: always # never: 不向任何人展示详细信息；when_authorized: 仅对已认证并被授权的用户展示详细信息；always: 对所有人展示所有详细信息（谨慎使用）；
  endpoints:
    web:
      # Actuator 暴露的端点路径
      base-path: /rest/actuator
      exposure:
        # 常用端点：/info 应用基本信息，/health 健康度信息，/metrics 运行指标，/env 环境变量信息，/loggers 日志相关，/dump 线程相关信息，/trace 请求调用轨迹
        # 公开的端点列表。默认值为info, health
        include: health # 访问方式：http://localhost:8080/bamboo-api/rest/actuator/health

server:
  servlet:
    context-path: /bamboo-api
  port: 8080
  shutdown: graceful   # 优雅停服务，在容器关闭时，web服务器将不再接收新请求，并将等待活动请求完成的缓冲期。从springboot2.3.0引入的新特性
  error:
    # springboot2.5.3 ErrorController中删除了getErrorPath方法，改为走配置项，默认是：/error
    path: /error
  tomcat:
    basedir: .
    accesslog:
      buffered: true # 设置是否缓存日志，默认值为true，当设置为false时，每个request都会立刻产生访问日志
      directory: logs # 指定access文件的路径
      enabled: true # 取值true、false，需要accesslog时设置为true
      file-date-format: .yyyy-MM-dd # 是设置滚动生成文件的格式，如yyyy-MM-dd是每天滚动生成新日志文件，yyyy-MM-dd.HH是每小时滚动生成新的日志文件。
      # Access log内置了两个日志格式模板，可以直接指定pattern为模板名称
      # common - %h %l %u %t "%r" %s %b，依次为：远程主机名称，远程用户名，被认证的远程用户，日期和时间，请求的第一行，response code，发送的字节数
      # combined - %h %l %u %t "%r" %s %b "%{Referer}i" "%{User-Agent}i"，依次为：远程主机名称，远程用户名，被认证的远程用户，日期和时间，请求的第一行，response code，发送的字节数，request header的Referer信息，request header的User-Agent信息。
      pattern: combined # 设置日志的格式，指定pattern为模板名称
      prefix: access # 日志文件的文件名后缀
      rename-on-rotate: false # 是否延迟在文件名中包含日期戳，直到旋转时间。
      request-attributes-enabled: false # 设置请求的IP地址，主机名，协议和端口的请求属性。
      suffix: .log # 日志文件的文件名后缀
      max-days: 7  # 设定保留7天的日志文件，已验证，此参数可真实有效删除access日志文件。
      rotate: true # 是否启用访问日志轮换。

spring:
  profiles:
    active: dev
  servlet:
    multipart:
      # 单文件上传大小限制
      max-file-size: 10MB
      # 请求的大小（文件总大小 + 其他表单数据）限制
      max-request-size: 10MB
  main:
    # 解决bean重复定义。设置为true，后定义bean覆盖之前定义相同名称的bean。springboot2.0.4开始支持，默认为rue；springboot2.1.0开始默认false
    allow-bean-definition-overriding: true
    # springboot2.6.0 以后的版本默认禁止 Bean 之间的循环引用，默认为false
    allow-circular-references: true
  application:
    # 应用名
    name: bamboo-api
  session:
    store-type: redis
    redis:
      namespace: demo-session-namespace
      flush-mode: on-save
#  session:
#    store-type: redis
#    redis:
#      namespace: spring::session

mybatis-plus:
  mapper-locations: classpath:mapper/**/*.xml
  # 关闭mybatis-plus的banner打印
  global-config:
    banner: false
    db-config:
      logic-delete-value: 1
      logic-not-delete-value: 0
# PageHelper 配置
pagehelper:
  autoDialect: true               # 启用自动方言，自动识别数据库类型并选择适配的方言。
  reasonable: true                # 分页合理化
  supportMethodsArguments: true   # 支持通过参数控制
  count-column: "*"               # 计算总记录数时查询所有列，通常为 *
  async-count: true               # 异步查询总记录数，提升分页查询性能。
  params: count=countSql          # 设置为 SQL 语句中的 count 查询
  banner: false                   # 关闭banner打印


# springdoc-openapi项目配置
springdoc:
  swagger-ui:
    path: /swagger-ui.html
    tags-sorter: alpha
    operations-sorter: alpha
  api-docs:
    path: /v3/api-docs
  group-configs:
    - group: 'bamboo-api'
      paths-to-match: '/**'
      packages-to-scan:
      - 'com.nutcracker.web.rest'
      - 'com.nutcracker.web.auth.controller'
# knife4j的增强配置，不需要增强可以不配
knife4j:
  setting:
    language: zh_cn

# security 配置
security:
  #同一账号，最大登录数
  max-session: 10
  # 超出最大登录数，是否阻止登录
  prevents-login: false

app:
  secret:
    pool-size: 3

jwt:
  secret: GZoxfbQ0dDIqSqwvtc2WdstvJaACU3QKALjkHnp3C78=


# 验证码配置
captcha:
  # 验证码类型 circle-圆圈干扰验证码|gif-Gif验证码|line-干扰线验证码|shear-扭曲干扰验证码
  type: circle
  # 验证码宽度
  width: 120
  # 验证码高度
  height: 40
  # 验证码干扰元素个数
  interfere-count: 2
  # 文本透明度(0.0-1.0)
  text-alpha: 0.8
  # 验证码字符配置
  code:
    # 验证码字符类型 math-算术|random-随机字符
    type: math
    # 验证码字符长度，type=算术时，表示运算位数(1:个位数运算 2:十位数运算)；type=随机字符时，表示字符个数
    length: 1
  # 验证码字体
  font:
    # 字体名称 Dialog|DialogInput|Monospaced|Serif|SansSerif
    name: SansSerif
    # 字体样式 0-普通|1-粗体|2-斜体
    weight: 1
    # 字体大小
    size: 24
  # 验证码有效期(秒)
  expire-seconds: 120

# 微信小程配置
wx:
  miniapp:
    app-id: xxxxxx
    app-secret: xxxxxx